GITHUB	        ="https://github.com/apsumin/rocket-influence"
SUPABASE        ="https://supabase.com/dashboard/project/dfkeshhcxzqdafjfnxyx"
QDRANT	        ="https://15af0a7f-12ff-481f-88fe-6da3734e8c13.us-east4-0.gcp.cloud.qdrant.io:6333/dashboard#/collections"

supabase_url    ="https://dfkeshhcxzqdafjfnxyx.supabase.co"
supabase_key    ="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRma2VzaGhjeHpxZGFmamZueHl4Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTAyMzY3MTYsImV4cCI6MjA2NTgxMjcxNn0.EHxmcTzQ13c-j-6awsKp3fQVY8BUJVNdJNEc3OAl1Eo"

QDRANT_URL      ="https://15af0a7f-12ff-481f-88fe-6da3734e8c13.us-east4-0.gcp.cloud.qdrant.io:6333"
QDRANT_API_KEY  ="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhY2Nlc3MiOiJtIn0.aXa8OyzTkUKWUccpB2SiRfl5S-WdwzI-MuGkgaMmN1Y"







RT_VIDEOTRANSCRIPTION_TABLE_V2 	="rt_videotranscription_v2"
__IS_VECTORIZED__           	="is_vectorized"
__TEXT__                    	="text"
__IS_VECTORIZED_V2__        	="is_vectorized_v2"
__IS_ANALIZED_V2__        	="is_analyzed_v2"
CHANNELID = "channelid"
CHANNEL_ID = "channel_id"
CHANNEL_NAME = "channel_name"

VERSION     ="1.0.1.3"
INFO        =f"Rocket Influence Middleware server. v{VERSION}"
COLLECTION  ="rocket-influence"
USING       ="descriptions"

HYBRID_COLLECTION_V2 = "rocket-influence-hybrid-V2"
CATEGORIES_COLLECTION_V2 = "rocket-influence-business-categories-V2"



HYBRID_COLLECTION_V6 = "rocket-influence-hybrid-V6"
HYBRID_COLLECTION_V7 = "rocket-influence-hybrid-V7"

#MODEL  	="paraphrase-multilingual-MiniLM-L12-v2"
MODEL   = "sentence-transformers/paraphrase-multilingual-mpnet-base-v2"
MODEL2  = "sentence-transformers/paraphrase-multilingual-mpnet-base-v2"

MODEL6 = "sentence-transformers/paraphrase-multilingual-mpnet-base-v2"
#MODEL = "DeepPavlov/rubert-base-cased"

#CATEGORIES="./categories/okved.json"
#CATEGORIES="./categories/categories@v1.2.json"
CATEGORIES="./categories/categories@v1.4.json"


DESCRIPTION_VECTOR="description"
TITLE_VECTOR="title"
TEXT_VECTOR="text"

VECTORED_TAGS=[
    "лучшие итальянские блюда",
    "адыгейский сыр",
    "как готовить макароны",
    "как хорошо выглядеть в 40 лет",
    "про разработку ИИ",
    "про криптовалюту и биткоины",
    "как правильно и хорошо спланировать дом",
    "про дорогую недвижимость в Дубае",
    "про дорогую недвижимость в Москве",
    "про дорогую недвижимость в Турции",
    "про немецкие автомобили",
    "про японские автомобили",
    "про автомобиль Делориан",
    "про автомобиль Audi A7",
    "новые жилые комплексы в Москве и Подмосковье",
    "про тест драйв немецких автомобилей",
    "про тест драйв японских автомобилей",
    "про тест драйв российских автомобилей",
    "новые жилые комплексы в Москве и Подмосковье",
    "про войну в Украине",
    "встреча Путина и Трампа на Аляске",
    "про сталинские лагеря",
    "путешествовать по америке"
    "",
    "Как купить квартиру в ипотеку с низким первоначальным взносом?",
"Где найти элитную загородную недвижимость под Москвой?",
"Как оценить рыночную стоимость квартиры перед продажей?",
"Какие документы нужны для оформления аренды коммерческой недвижимости?",
"Как выбрать надежного риэлтора для покупки дома?",
"Где искать новостройки с готовой отделкой?",
"Как законно снизить налоги при продаже недвижимости?",
"Какие районы Санкт-Петербурга самые престижные для жилья?",
"Как оформить договор долевого участия в строительстве?",
"Где найти участки под ИЖС в Подмосковье?",
"Как проверить юридическую чистоту квартиры перед покупкой?",
"Какие таунхаусы строят в Краснодарском крае?",
"Как получить разрешение на реконструкцию частного дома?",
"Где купить квартиру в историческом центре Казани?",
"Как рассчитать ежемесячный платеж по ипотечному кредиту?",
"Какие элитные коттеджные поселки есть под Нижним Новгородом?",
"Как оформить дарственную на квартиру родственнику?",
"",
"Где продать подержанный автомобиль быстро и выгодно?",
"Как правильно оформить договор купли-продажи авто?",
"Какие сайты лучше для продажи автомобилей с пробегом?",
"Как подготовить машину к продаже для максимальной цены?",
"Где найти надежного перекупщика автомобилей?",
"Как проверить историю автомобиля перед покупкой?",
"Какие документы нужны для постановки авто на учет?",
"Как определить рыночную стоимость своего автомобиля?",
"Где можно продать автомобиль без регистрации?",
"Как провести предпродажную подготовку авто?",
"Какие автохаусы покупают машины с пробегом?",
"Как безопасно провести сделку купли-продажи?",
"Где найти покупателей на элитные автомобили?",
"Как оформить генеральную доверенность на автомобиль?",
"Какие комиссии берут автосалоны за продажу авто?",
"Как продать автомобиль, если он в кредите?",
"",
"Какие горнолыжные курорты самые популярные в России?",
"Как оформить туристическую визу в Шенген?",
"Где найти туры по Золотому кольцу России?",
"Как выбрать туроператора для отдыха за границей?",
"Какие санатории Кавказских Минеральных Вод лучшие?",
"Как получить туристический налоговый вычет?",
"Где найти туры на Алтай с гидом?",
"Как оформить медицинскую страховку для выезда за границу?",
"Какие экологические туры есть в Байкале?",
"",
"Как обучить нейросеть для распознавания изображений?",
"Какие языки программирования используют для машинного обучения?",
"Как создать чат-бота с использованием NLP?",
"Какие фреймворки для глубокого обучения самые популярные?",
"Как работает алгоритм обратного распространения ошибки?",
"Как разработать систему рекомендаций для интернет-магазина?",
"Какие этические проблемы в искусственном интеллекте?",
"Как создать генеративно-состязательную сеть (GAN)?",
"Как использовать трансформеры для обработки текста?"



]

CHANNELS=[
    {
        "channel_name": ""
    },

    {
        "channel_name": "#ХОЧУКВАРТИРУ"
    },
    {
        "channel_name": "AcademeG"
    },
    {
        "channel_name": "Alan Enileev"
    },
    {
        "channel_name": "Alanya - Жизнь без купюр"
    },
    {
        "channel_name": "Alexander Kondrashov"
    },
    {
        "channel_name": "Alexandra Sokolova - Income Mersin Real Estate"
    },
    {
        "channel_name": "Andrey Burenok"
    },
    {
        "channel_name": "ASATA “BORODA” channel"
    },
    {
        "channel_name": "BitNovosti.com"
    },
    {
        "channel_name": "Blockchain Pro Channel"
    },
    {
        "channel_name": "carwow Русская версия"
    },
    {
        "channel_name": "Clickoncar"
    },
    {
        "channel_name": "Combat Crew"
    },
    {
        "channel_name": "CryptoFateev Ripple XRP Трейдер"
    },
        {
            "channel_name": "CRYPTUS"
        },
        {
            "channel_name": "CSCALP TV"
        },
      {
        "channel_name": "DragtimesInfo"
      },
      {
        "channel_name": "DSC OFF"
      },
      {
        "channel_name": "Era of change finance"
      },
      {
        "channel_name": "forklog"
      },
      {
        "channel_name": "GOOD WOOD Строительство домов"
      },
      {
        "channel_name": "HAMAHA"
      },
      {
        "channel_name": "HomeHunter"
      },
      {
        "channel_name": "Ilia Bondarev"
      },
      {
        "channel_name": "Ivan Zenkevich PRO Cars"
      },
      {
        "channel_name": "JETCAR"
      },
      {
        "channel_name": "Kirill Evans"
      },
      {
        "channel_name": "M2TV - Недвижимость с экспертами"
      },
      {
        "channel_name": "MAJORKA"
      },
      {
        "channel_name": "Mike Supercars TopSpeed (Supercars Miami)"
      },
      {
        "channel_name": "On The Roofs"
      },
      {
        "channel_name": "Pilot Alexander"
      },
      {
        "channel_name": "Prometheus"
      },
      {
        "channel_name": "REPEY - курортная недвижимость"
      },
      {
        "channel_name": "RestProperty Недвижимость в Турции"
      },
      {
        "channel_name": "Samsebeskazal Denis"
      },
      {
        "channel_name": "SEVEN FORCE"
      },
      {
        "channel_name": "smotraTV"
      },
      {
        "channel_name": "The Life of Others"
      },
      {
        "channel_name": "Travel TV Bogdan Bulychev / BogDee"
      },
      {
        "channel_name": "varlamov"
      },
      {
        "channel_name": "VDT l Влог о недвижимости и строительстве"
      },
      {
        "channel_name": "Vitaliy and Liza"
      },
      {
        "channel_name": "Wylsacom"
      },
      {
        "channel_name": "zaRRubin"
      },
      {
        "channel_name": "АВТО ПЛЮС"
      },
      {
        "channel_name": "АНАПЧАНЕ"
      },
      {
        "channel_name": "Антон Воротников"
      },
      {
        "channel_name": "Антон Птушкін"
      },
      {
        "channel_name": "Архитектор Виталий Злобин"
      },
      {
        "channel_name": "Асафьев Стас"
      },
      {
        "channel_name": "Большой тест-драйв"
      },
      {
        "channel_name": "Виктор Садыгов | Москва, Дорогая"
      },
      {
        "channel_name": "Гараж 54"
      },
      {
        "channel_name": "Дима Гордей"
      },
      {
        "channel_name": "ДОМ у МОРЯ"
      },
      {
        "channel_name": "Жекич Дубровский"
      },
      {
        "channel_name": "Игорь Зуевич"
      },
      {
        "channel_name": "ИЛЬДАР АВТО-ПОДБОР"
      },
      {
        "channel_name": "Касё Гасанов"
      },
      {
        "channel_name": "Лиса Рулит"
      },
      {
        "channel_name": "Максим Шелков"
      },
      {
        "channel_name": "Мастерская Синдиката"
      },
      {
        "channel_name": "Маша Себова"
      },
      {
        "channel_name": "МИР НАИЗНАНКУ"
      },
      {
        "channel_name": "Михаил Ширвиндт"
      },
      {
        "channel_name": "Моя Планета"
      },
      {
        "channel_name": "Настя Туман"
      },
      {
        "channel_name": "О НОВОСТРОЙКАХ"
      },
      {
        "channel_name": "Орел и Решка"
      },
      {
        "channel_name": "ПОЕХАВШИЙ"
      },
      {
        "channel_name": "ПриветТачка"
      },
      {
        "channel_name": "Роман Томера"
      },
      {
        "channel_name": "Сергей Смирнов про инвестиции и недвижимость"
      },
      {
        "channel_name": "СЛЕЗЫ САТОШИ"
      },
      {
        "channel_name": "ХОЧУ ДОМОЙ - Путешествия, в которые вы не поедете"
      },
      {
        "channel_name": "Ян Буян - Путешествия"
      }
]

OPTIONS = [
        {"value": "title", "text": "Video Title"},
        {"value": "description", "text": "Video Description"},
        {"value": "text", "text": "Video Transcription"},
        {"value": "all", "text": "All Vectors Above Combined"}
]


HTML = """
    <!DOCTYPE html>
    <html lang="en">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Qdrant Semantic Search</title>
    <style>
        body {
            font-family: Verdana, Geneva, sans-serif;
            background-color: #f5f5f5;
            font-size: 12px; /* Optional: Set a base font size */
        }
        .form-container {
            background-color: #D3D3D3;
            padding: 10px;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            width: 80%;
            max-width: 600px;
        }
        h2 {
            color: #333;
            margin-top: 0;
            margin-bottom: 12px;
            text-align: center;
        }

        .form-group {
            margin-bottom: 20px;
        }
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: #555;
        }
        select, input[type="text"] {
            width: 100%;
            padding: 5px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 12px;
            box-sizing: border-box;
            transition: border-color 0.3s;
        }
        select:focus, input[type="text"]:focus {
            outline: none;
            border-color: #4a90e2;
            box-shadow: 0 0 0 2px rgba(74, 144, 226, 0.2);
        }
        .button-container {
            position: relative;
        }
        button {
            background-color: #4a90e2;
            color: white;
            border: none;
            padding: 12px 24px;
            font-size: 12px;
            border-radius: 4px;
            cursor: pointer;
            width: 100%;
            transition: background-color 0.3s;
        }
        button:hover {
            background-color: #357abd;
        }
        button:active {
            background-color: #2968a3;
        }
        h4 {
            color: blue;
            margin-bottom: 10px;
        }

        /* Class for red headings */
        .red-text {
            color: red;
        }

        /* Class for green headings */
        .green-text {
            color: green;
        }

        /* Spinner Styles */
        .spinner {
            display: none;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: white;
            position: absolute;
            top: 50%;
            left: 50%;
            margin-left: -10px;
            margin-top: -10px;
            animation: spin 1s ease-in-out infinite;
        }
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        /* Overlay to prevent interaction during submission */
        .overlay {
            display: none;
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(255, 255, 255, 0.7);
            z-index: 10;
            border-radius: 8px;
        }

        table, th, td {
            font-family: Verdana, Geneva, sans-serif;
            font-size: 12px; /* Optional: Set a base font size */

            border: 0.5px solid;
            border-collapse: collapse;
      }
      tr:nth-child(odd) {
        background-color: lightgray;
      }
      tr:nth-child(even) {
        background-color: white;
      }
      .my-table {
        width: 100%;
        border: 0.5px solid;
        border-collapse: collapse;
      }
      .my-table_2 {
        width: 60%;
        border: 0.5px solid;
        border-collapse: collapse;
      }
      .col-5 {
        width: 5%;
        vertical-align: top;
      }

      .col-10 {
        width: 10%;
        vertical-align: top;
      }
      .col-30 {
        width: 30%;
        vertical-align: top;
      }
      .col-20 {
        width: 20%;
        vertical-align: top;
      }
      .col-50 {
        width: 50%;
        vertical-align: top;
      }
      .col-60 {
        width: 60%;
        vertical-align: top;
      }
    </style>
    <body>
"""


def scriptV5(url="/api/v5/search?q="):
    script = """
        <script>
            const contentDiv = document.getElementById('content');
            function truncateString(str, maxLength, suffix = '...') {
                if (str.length <= maxLength) return str;
                return str.slice(0, maxLength - suffix.length) + suffix;
            }
            document.addEventListener('DOMContentLoaded', function() {
                const form = document.getElementById('testForm');
                const submitButton = document.getElementById('submitButton');
                const spinner = document.getElementById('spinner');
                const overlay = document.getElementById('overlay');
                const channel = document.getElementById('channel');
                form.addEventListener('submit', function(e) {
                    e.preventDefault();
                    // Show spinner and overlay
                    spinner.style.display = 'block';
                    overlay.style.display = 'block';
                    submitButton.disabled = true;

                    // Get form data
                    const formData = new FormData(form);
                    const urlParams = new URLSearchParams(formData)

                    var payload = {"limit":25,"tags":[],"filters":[]}
                    for (let [key, value] of formData.entries()) {
                        if (key == "tag" && value.length!=0){
                            payload.tags.push (value)         
                        }
                        if (key == "channel_name" && value.length!=0){
                            payload.filters.push ({"index":key,"value":value})
                        }
                    }
    """
    script += f"var url = '{url}';"
    script += """
                    url+=`${JSON.stringify(payload)}`;
                    fetch(url)
                    .then(response => {
                        if (!response.ok) {
                            throw new Error('Network response was not ok');
                        }
                        return response.json(); // Parse JSON data
                    })
                    .then(data => {
                        var html="";
                        data.forEach(tag => {
                                html+=`<h4 class='green-text'>${tag.tag}:</h4>`
                                console.log (tag.tag)
                                html+='<table class="my-table"><tr><td class="col-5">Score</td><td class="col-10">Video Title</td><td class="col-20">URL</td><td class="col-10">Channel</td><td class="col-60">Video Transcription</td></tr>'                            
                                tag.value.forEach(hit => {
                                    html+=`<tr><td class='col-5'>${hit.score}</td><td class='col-10'>${hit.payload['title']}</td><td class='col-20'><a href='${hit.payload['url']}'>${truncateString(hit.payload['url'],50)}</a></td><td class='col-10'>${hit.payload['channel_name']}</td><td class='col-60'>${truncateString(hit.payload['text'], 2048)}</td></tr>`
                                    console.log (hit.score)
                                });
                                html+="</table>"                            
                        });
                        contentDiv.innerHTML    = html;//JSON.stringify(data);
                        spinner.style.display   = 'none';
                        overlay.style.display   = 'none';
                        submitButton.disabled   = false;
                    })
                    .catch(error => {
                        // Handle errors
                        contentDiv.innerHTML = `<p class="error">Error loading content: ${error.message}</p>`;
                        console.error('Error:', error);
                    });
                });
            });
        </script>
    """
    return script